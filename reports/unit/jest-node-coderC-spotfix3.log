PASS unit/api.messages.threads-and-messages.spec.ts
  ● Console

    console.log
      { ms: 6 } route_success

      at Object.POST (../apps/web/src/server/withRouteTiming.ts:107:11)

    console.log
      { ms: 2 } route_success

      at Object.POST (../apps/web/src/server/withRouteTiming.ts:107:11)

    console.log
      { ms: 5 } route_success

      at Object.POST (../apps/web/src/server/withRouteTiming.ts:107:11)

    console.log
      { ms: 2 } route_success

      at Object.GET (../apps/web/src/server/withRouteTiming.ts:107:11)

    console.log
      { ms: 1 } route_success

      at Object.GET (../apps/web/src/server/withRouteTiming.ts:107:11)

    console.log
      { ms: 1 } route_success

      at Object.PATCH (../apps/web/src/server/withRouteTiming.ts:107:11)

    console.log
      { ms: 2 } route_success

      at Object.GET (../apps/web/src/server/withRouteTiming.ts:107:11)

FAIL unit/api.files.content-type-default.spec.ts
  ● Console

    console.log
      { ms: 1 } route_success

      at Object.POST (../apps/web/src/server/withRouteTiming.ts:107:11)

    console.log
      { ms: 1 } route_success

      at Object.PUT (../apps/web/src/server/withRouteTiming.ts:107:11)

    console.log
      { ms: 0 } route_success

      at Object.GET (../apps/web/src/server/withRouteTiming.ts:107:11)

  ● files default content_type › defaults to application/octet-stream when omitted

    expect(received).toBe(expected) // Object.is equality

    Expected: "application/octet-stream"
    Received: "application/json"

      22 |     const { id } = await put.json();
      23 |     const dl = await (DownloadGET as any)(getUrl(`http://localhost/api/files/download-url?id=${id}`, { 'x-test-auth': 'student' }));
    > 24 |     expect(dl.headers.get('content-type')).toBe('application/octet-stream');
         |                                            ^
      25 |   });
      26 | });
      27 |

      at Object.<anonymous> (unit/api.files.content-type-default.spec.ts:24:44)

FAIL unit/api.files.download-url.dev-namespace.guard.spec.ts
  ● Console

    console.log
      { ms: 3 } route_success

      at Object.GET (../apps/web/src/server/withRouteTiming.ts:107:11)

  ● files download-url dev namespace guard › 403 when object_key missing DEV_ID prefix in dev with DEV_ID set

    expect(received).toBe(expected) // Object.is equality

    Expected: 403
    Received: 404

      16 |     jest.spyOn(supa as any, 'getRouteHandlerSupabase').mockReturnValue(mock);
      17 |     const res = await (DownloadGET as any)(get('http://localhost/api/files/download-url?id=someone_else/file.txt'));
    > 18 |     expect(res.status).toBe(403);
         |                        ^
      19 |   });
      20 | });
      21 |

      at Object.<anonymous> (unit/api.files.download-url.dev-namespace.guard.spec.ts:18:24)

Test Suites: 2 failed, 1 passed, 3 total
Tests:       2 failed, 1 passed, 3 total
Snapshots:   0 total
Time:        5.179 s
Ran all test suites matching /unit\/api.messages.threads-and-messages.spec.ts|unit\/api.files.content-type-default.spec.ts|unit\/api.files.download-url.dev-namespace.guard.spec.ts/i.
