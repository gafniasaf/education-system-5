FAIL tests/unit/ui/SystemHealthHistory.spec.tsx
  ‚óè System Health History (labs) ‚Ä∫ renders delta stats and timestamps with jitter

    TypeError: Resp is not a constructor

      37 |       try { const u = require('undici'); Resp = u.Response; } catch {}
      38 |     }
    > 39 |     return new Resp(JSON.stringify({ ok: false }), { status: 404, headers: { 'content-type': 'application/json' } });
         |            ^
      40 |   };
      41 | }
      42 |

      at g.fetch (shims/msw-node.ts:39:12)
      at g.fetch (shims/msw-node.ts:34:53)
      at serverFetch (../apps/web/src/lib/serverFetch.ts:74:21)
      at fetchJson (../apps/web/src/lib/serverFetch.ts:88:21)
      at Object.get (../apps/web/src/lib/data/health.ts:14:23)
      at takeSamples (../apps/web/src/app/labs/system/health-history/page.tsx:11:47)
      at HealthHistoryPage (../apps/web/src/app/labs/system/health-history/page.tsx:34:25)
      at Object.<anonymous> (unit/ui/SystemHealthHistory.spec.tsx:15:39)

FAIL tests/unit/ui/SystemUptimeTile.spec.tsx
  ‚óè System Uptime Tile (labs) ‚Ä∫ renders ok and ts fields under jitter

    Unable to find an element by: [data-testid="uptime-ok"]

    Ignored nodes: comments, script, style
    [36m<body>[39m
      [36m<div>[39m
        [36m<main[39m
          [33mclass[39m=[32m"p-6"[39m
        [36m>[39m
          [36m<h1[39m
            [33mclass[39m=[32m"text-xl font-semibold"[39m
          [36m>[39m
            [0mSystem uptime[0m
          [36m</h1>[39m
          [36m<p[39m
            [33mclass[39m=[32m"text-gray-700"[39m
          [36m>[39m
            [0mUnable to load uptime.[0m
          [36m</p>[39m
        [36m</main>[39m
      [36m</div>[39m
    [36m</body>[39m

      16 |     const ui = await UptimeTilePage();
      17 |     render(ui);
    > 18 |     await screen.findByTestId('uptime-ok');
         |                  ^
      19 |     await screen.findByTestId('uptime-ts-iso');
      20 |     await screen.findByTestId('uptime-ts-human');
      21 |   });

      at waitForWrapper (../node_modules/@testing-library/dom/dist/wait-for.js:163:27)
      at ../node_modules/@testing-library/dom/dist/query-helpers.js:86:33
      at Object.<anonymous> (unit/ui/SystemUptimeTile.spec.tsx:18:18)

FAIL tests/unit/ui/SystemRoleBadge.spec.tsx
  ‚óè System Role Badge (labs) ‚Ä∫ renders role and test mode

    TypeError: Resp is not a constructor

      37 |       try { const u = require('undici'); Resp = u.Response; } catch {}
      38 |     }
    > 39 |     return new Resp(JSON.stringify({ ok: false }), { status: 404, headers: { 'content-type': 'application/json' } });
         |            ^
      40 |   };
      41 | }
      42 |

      at g.fetch (shims/msw-node.ts:39:12)
      at g.fetch (shims/msw-node.ts:34:53)
      at serverFetch (../apps/web/src/lib/serverFetch.ts:74:21)
      at fetchJson (../apps/web/src/lib/serverFetch.ts:88:21)
      at Object.get (../apps/web/src/lib/data/health.ts:14:23)
      at SystemRoleBadgePage (../apps/web/src/app/labs/system/role-badge/page.tsx:10:44)
      at Object.<anonymous> (unit/ui/SystemRoleBadge.spec.tsx:15:41)

Test Suites: 3 failed, 3 total
Tests:       3 failed, 3 total
Snapshots:   0 total
Time:        5.878 s
Ran all test suites related to files matching /tests\/unit\/ui\/SystemHealthHistory.spec.tsx|tests\/unit\/ui\/SystemUptimeTile.spec.tsx|tests\/unit\/ui\/SystemRoleBadge.spec.tsx/i.
